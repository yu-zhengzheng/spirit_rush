Qoder Log - 2026-01-22
根据 main_game_loop.mmd 对游戏逻辑进行了以下重大重构：

1. 回合流转逻辑调整：
   - 引入了明确的“回合制”循环。
   - 回合开始时会自动触发随机事件检测（模拟 MMD 中的“LLM生成随机事件”）。
   - 玩家可以自由执行多个动作，直到点击“结束回合”按钮。

2. 宗门管理功能增加 (根据 MMD)：
   - Player 类中新增了 sect_data 属性，用于跟踪弟子人数（挖矿、招募）和宗门设施等级（灵库、洞府）。
   - 在底部操作栏新增了“弟子”和“宗门”按钮。
   - 实现了初步的弟子管理逻辑：玩家可以派遣弟子挖矿。
   - 实现了初步的宗门扩建逻辑：玩家可以花费灵石升级灵库。

3. UI 界面更新：
   - 底部按钮组从 6 个扩展到 9 个，新增了“弟子”、“宗门”和“结回”（结束回合）按钮。
   - 重新排布了按钮布局以适应新增功能。

4. 回合结算系统：
   - 只有在玩家点击“结束回合”后才会进入结算阶段。
   - 结算阶段会计算宗门弟子的产出（如挖矿弟子产出灵石）。
   - 结算完成后会自动开启下一回合。

5. 细节优化：
   - 移除了修炼、打坐、挖矿等操作后强制结束回合的逻辑，使游戏更符合策略模拟器的节奏。
   - 保留了突破境界时即时触发特殊事件的逻辑。

Kimi-K2-0905 2026-02-04 修改记录：
- 重写 cli.py 中的 load_save 方法，显示存档文件名
- 现在玩家可以看到存档文件名、年份和保存时间，选择对应的编号进行读取
- 改进了用户体验，让玩家能清楚知道自己在读取哪个存档文件

Kimi-K2-0905 2026-02-04 第二次修改：
- 修改 get_save_files() 函数，让它包含完整的存档数据
- 重写 GameCLI.load_save() 方法，不再直接调用 load_game() 读取文件
- 现在 load_save() 直接使用 get_save_files() 提供的数据，避免重复文件读取操作

Kimi-K2-0905 2026-02-04 第三次修改：
- 修改 get_save_files() 函数，返回字典格式：键是int(1对应save_1.json)，值是存档数据
- 重写 GameCLI.load_save() 方法，适配新的字典返回格式
- 现在显示和选择都基于真实的槽位号，更加直观

MiniMax-M1.1 2026-02-05
修改内容：cli.py 动态计算扩建提示
- 将“灵库扩建成功！上限+100”改为显示实际数值变化（动态获取扩建前后的 max_wealth）
- 将“洞府扩建成功！上限+5”改为显示实际数值变化（动态获取扩建前后的 max_disciples）
- 利用 game_state.py 中的 property 方法（max_wealth、max_disciples）实时计算当前上限

MiniMax-M1.1 2026-02-05
修改内容：cli.py 修复 GameCLI.LLM_summary() 方法
- 将 self.state.to_dict() 转换为字符串格式，避免直接传递字典对象给 LLM
- 将 log_message 改为 log_action，与代码中其他日志记录方式保持一致
- 优化提示词结构，提取为独立变量提高可读性