Qoder Log - 2026-01-22
==========================

根据 main_game_loop.mmd 对游戏逻辑进行了以下重大重构：

1. 回合流转逻辑调整：
   - 引入了明确的“回合制”循环。
   - 回合开始时会自动触发随机事件检测（模拟 MMD 中的“LLM生成随机事件”）。
   - 玩家可以自由执行多个动作，直到点击“结束回合”按钮。

2. 宗门管理功能增加 (根据 MMD)：
   - Player 类中新增了 sect_data 属性，用于跟踪弟子人数（挖矿、招募）和宗门设施等级（灵库、洞府）。
   - 在底部操作栏新增了“弟子”和“宗门”按钮。
   - 实现了初步的弟子管理逻辑：玩家可以派遣弟子挖矿。
   - 实现了初步的宗门扩建逻辑：玩家可以花费灵石升级灵库。

3. UI 界面更新：
   - 底部按钮组从 6 个扩展到 9 个，新增了“弟子”、“宗门”和“结回”（结束回合）按钮。
   - 重新排布了按钮布局以适应新增功能。

4. 回合结算系统：
   - 只有在玩家点击“结束回合”后才会进入结算阶段。
   - 结算阶段会计算宗门弟子的产出（如挖矿弟子产出灵石）。
   - 结算完成后会自动开启下一回合。

5. 细节优化：
   - 移除了修炼、打坐、挖矿等操作后强制结束回合的逻辑，使游戏更符合策略模拟器的节奏。
   - 保留了突破境界时即时触发特殊事件的逻辑。
